# MPE-Automatic-report-generation-for-Medical-Images


### Project Showcase

1. **Joint Model's Block Diagram**  
![Joint Model's block diagram](https://github.com/collect1on/MPE-Automatic-report-generation-for-Medical-Images/blob/main/folder_for_readme_picture/Joint%20Model's%20block%20diagram.png)

2. **Vector Dimension Change Block Diagram**  
![Vector Dimension Change Block Diagram](https://github.com/collect1on/MPE-Automatic-report-generation-for-Medical-Images/blob/main/folder_for_readme_picture/Vector%20Dimension%20Change%20Block%20Diagram%20.png)

3. **Test Results Example**  
![Test results example](https://github.com/collect1on/MPE-Automatic-report-generation-for-Medical-Images/blob/main/folder_for_readme_picture/Test%20results%20example.png)

4. **Text Quality Metrics Evaluation and Boxplot**  
![Text quality metrics evaluation and Text quality metrics evaluation boxplot](https://github.com/collect1on/MPE-Automatic-report-generation-for-Medical-Images/blob/main/folder_for_readme_picture/Text%20quality%20metrics%20evaluation%20and%20Text%20quality%20metrics%20evaluation%20boxplot.png)




This project is my individual Master's research project, which took one year to complete.  
The full details can be found in **Project Report.pdf**.  

Below is the complete execution workflow:


0. **Set Up Development Environment**  

   I used the `project_environment.yml` file to configure the environment.
   Please adjust the environment setup according to your own system and requirements.

1. **Fine-tuning LLaMA 3**  
   Run `train_llama_pretrained.py` to fine-tune the LLaMA 3 model.

2. **Baseline Report Generation (Pre-trained LLaMA 3)**  
   Run `llama3_base_radiology_report_generation_inference_comparison.py` to generate simulated medical reports using the original pre-trained LLaMA 3.

3. **Report Generation with Fine-tuned LLaMA 3**  
   Run `llama3_finetuned_indiana_radiology_report_generation_inference_comparison.py` to generate simulated medical reports using the fine-tuned LLaMA 3.  
   By comparing the reports generated by the original LLaMA 3 and the fine-tuned LLaMA 3, we can demonstrate that fine-tuning enables the model to effectively use domain-specific medical terminology.

4. **Training the Joint Vision-Language Model**  
   Run `vision_language_joint_finetuning.py` to train the joint model, which consists of:
   - Fine-tuned LLaMA 3 (language model)  
   - Projection model  
   - ConvNeXt V2 (vision model)

5. **Medical Report Generation and Evaluation**  
   Run `generate_finetuning_llama3_medical_reports_bleu.py` to test the trained joint model.  
   - Input: Medical images  
   - Output: Generated medical reports  
   - Evaluation: BLEU score

---
